<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.5.3/d3.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/topojson/1.6.9/topojson.min.js"></script>
    <script src="parse.js"></script>
    
    
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/3.0.2/topojson.min.js"></script>
    
    <title>Document</title>
</head>
<body>
    <div>
        <h4>canadian map divided by provinces, geo json</h4>
        <article id=map1>
            article
        </article>
        <div id="container" style="position: relative; width: 500px; height: 300px;"></div>
    </div>
    <script>
         const canvas = d3.select('body')
                .append('svg')
                .attr('width', '800')
                .attr('height', '800')
                .style('background-color', '#eeeeee')
      
        d3.json("canada_provinces.json").then((data) => {
            const group = canvas.selectAll('g')
                            .data(data.features)
                            .enter()
                            .append('g')

            const projection = d3.geoMercator().scale([400]).translate([1000,950]);
            const path = d3.geoPath().projection(projection);

            const areas = group.append("path")
                .attr('d', path)
                .attr('class', 'area')
                .attr('fill', 'steelblue')

            // group.append('text')
            //     .attr('x', (data) => { return path.centroid(data)[0]; })
            //     .attr('y', (data) => { return path.centroid(data)[1]; })
            //     .attr('text-anchor', 'middle' )
            //     .style('font-size', '10px')
            //     .text((data)=>{ return data.properties.PRENAME;})

         
            
            

            d3.select(window).on('resize', () => { return canvas.resize()})
    });

    //sample csv data maniplulation
    fetch('travel_to_canada_province.csv')
        .then(response => response.text())
        .then((data) => { 
          const arr = parseCSV(data);
          newArr = [];
          arr.forEach((ele) =>{
            if (( ele[1] == "Newfoundland and Labrador" ||
                        ele[1] == "Prince Edward Island" ||
                        ele[1] == "Nova Scotia" ||
                        ele[1] == "New Brunswick" ||
                        ele[1] == "Quebec" ||
                        ele[1] == "Ontario" ||
                        ele[1] == "Manitoba" ||
                        ele[1] == "Saskatchewan" ||
                        ele[1] == "Alberta" ||
                        ele[1] == "British Columbia" ||
                        ele[1] == "Yukon" ||
                        ele[1] == "Nunavut") && 
                        ele[3] == "Total non resident tourists" &&
                        ele[4] == "Unadjusted" &&
                        ele[0][0] == '2'
                        ) {
                            newArr.push([ele[0], ele[1], ele[11]]);
                        }
            return newArr;
            })
        console.log(newArr);
        });
        
          


    
      
    </script>
</body>
</html>