<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="parse.js"></script>  
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/3.0.2/topojson.min.js"></script>
    
    <title>Non-residential Tourists to Canada by provinces</title>
    <style>
        .area {
            stroke: white;
            stroke-width: 0.2px;
        }
        .area:hover {
            fill: rgb(229, 173, 151);
        }
    </style>
</head>
<body>
    <div>
        <h2>Non-Residential Tourists to Canada by Provinces</h2>
    </div>
    <script>

        
         const canvas = d3.select('body')
                .append('svg')
                .attr('width', '1550')
                .attr('height', '750')
                .style('background-color', '#eeeeee')
      
        d3.json("canadaProvinces.json").then((data) => {
            const group = canvas.selectAll('g')
                            .data(data.features)
                            .enter()
                            .append('g')

            const projection = d3.geoMercator().scale([450]).translate([1150,930]);
            const path = d3.geoPath().projection(projection);

            const areas = group.append("path")
                .attr('d', path)
                .attr('class', 'area')
                .attr('fill', 'steelblue')
            .append('title')
                .text((d) => d.properties.PRENAME);
            
            // const provinces = feature(data, data.objects.provinces);
            // svg.selectAll('path').data(provinces.features)
            //     .enter().append('path')
            //         .attr('class', 'province')
            //         .attr('title', 'hello Canada')
            //         .attr('d', path)


            // group.append('text')
            //     .attr('x', (data) => { return path.centroid(data)[0]; })
            //     .attr('y', (data) => { return path.centroid(data)[1]; })
            //     .attr('text-anchor', 'middle' )
            //     .style('font-size', '10px')
            //     .text((data)=>{ return data.properties.PRENAME;})

         
            
            

            d3.select(window).on('resize', () => { return canvas.resize()})
    });

    //sample csv data maniplulation
    fetch('travel_to_canada_province.csv')
        .then(response => response.text())
        .then((data) => { 
          const arr = parseCSV(data);
          newArr = [];
          arr.forEach((ele) =>{
            if (( ele[1] == "Newfoundland and Labrador" ||
                        ele[1] == "Prince Edward Island" ||
                        ele[1] == "Nova Scotia" ||
                        ele[1] == "New Brunswick" ||
                        ele[1] == "Quebec" ||
                        ele[1] == "Ontario" ||
                        ele[1] == "Manitoba" ||
                        ele[1] == "Saskatchewan" ||
                        ele[1] == "Alberta" ||
                        ele[1] == "British Columbia" ||
                        ele[1] == "Yukon" ||
                        ele[1] == "Nunavut") && 
                        ele[3] == "Total non resident tourists" &&
                        ele[4] == "Unadjusted" &&
                        ele[0][0] == '2'
                        ) {
                            newArr.push([ele[0], ele[1], ele[11]]);
                        }
            return newArr;
            })
        // console.log(newArr);
        });
        
          


    
      
    </script>
</body>
</html>